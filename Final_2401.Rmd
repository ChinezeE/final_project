---
title: "Final Project: Cereals"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown



```{r}
#install.packages("treemap")
library(treemap, warn.conflicts = F)
library(readr, warn.conflicts = F)
library(tidyverse, warn.conflicts = F)
library(dplyr, warn.conflicts = F)
library(ggplot2, warn.conflicts = F) 
cereal <- read_csv("DATA 2401/cereal.csv", na = "-1")
glimpse(cereal)
```
# Types of cereal: Hot vs Cold
```{r message = FALSE, warning = FALSE}
cereal %>% 
  count(type)
```


# ounces to grams:
```{r message = FALSE, warning = FALSE}
#Renaming and adjusting the columns 
cereal <- cereal %>% 
  mutate(weight_grams = round(weight*28.3495, digits = 0), weight_ounces = weight, rating = ceiling(rating)) %>% 
  subset(select = -weight)
cereal

```

#Which cereal has the highest calories per serving? Which cereals have the lowest calories per serving?

```{r message = FALSE, warning = FALSE, fig.dim = c(16, 10)}

cereal %>%
  ggplot(aes(x = reorder(name, calories), y = calories))+
  geom_col() +
  coord_flip()+ 
  labs(title = "Calories per Serving", x = "Name", y= "Calories")
  
```


#Which has the highest protein per serving?
```{r message = FALSE, warning = FALSE, fig.dim = c(15, 10)}
cereal %>% 
  select(name, calories, protein) %>% 
  arrange(desc(protein)) %>% 
  head(5)

cereal %>% 
  arrange(desc(protein)) %>% 
  ggplot(aes(x = protein, y = name, color = protein, fill = protein ))+
  geom_col() +
  labs(title = "Protein per Serving", x = "Protein", y= "Name")

```


#What is the relationship between sugar and calories? 
```{r message = FALSE, warning = FALSE}
cereal %>% 
  ggplot(aes(x = calories, y = sugars)) +
  geom_point()+
  geom_smooth()+ 
  theme_get()+
  labs(title = "Sugar vs Calories", x = "Calories", y= "Sugar")
```

#Which has the most fiber? Will high fiber cereals have lower calories per serving?  
```{r message = FALSE, warning = FALSE}

cereal %>% 
  ggplot(aes(x = calories, y = fiber, color= fiber)) +
  geom_smooth() +
  geom_point()+ 
  theme_get()+
  labs(title = "Fiber vs Calories", x = "Calories", y= "Fiber")

```

# Are there any keto-friendly cereals? Which are low-carb? 
```{r message = FALSE, warning = FALSE, fig.dim = c(12, 10)}

cereal %>% 
  ggplot(aes(x = carbo, y = name, color = carbo, fill = carbo))+
  geom_col() +
  labs(title = "Carbohydrates per Serving", x = "Carbohydrates", y= "Name")


```
#What factors determine the ratings of the cereals? What affects the ratings? 

```{r message = FALSE, warning = FALSE, fig.dim = c(10, 10)}
par(mfrow=c(3,3))
plot(cereal$calories, cereal$rating,  
 xlab="Calories",
 ylab="Rating",
 main="Rating vs Calories")
abline(lm(cereal$rating~cereal$calories), col="red")

plot(cereal$fat, cereal$rating, 
 xlab="Fat",
 ylab="Rating",
 main="Rating vs Fat")
abline(lm(cereal$rating~cereal$fat), col="red")

plot(cereal$sodium, cereal$rating,
 xlab="Sodium",
 ylab="Rating",
 main="Rating vs Sodium")
abline(lm(cereal$rating~cereal$sodium), col="red")

plot(cereal$carbo, cereal$rating,
 xlab="Carbohydrates",
 ylab="Rating",
 main="Rating vs Carbohydrates")
abline(lm(cereal$rating~cereal$carbo), col="red")

plot(cereal$fiber, cereal$rating,
 xlab="Fiber",
 ylab="Rating",
 main="Rating vs Fiber")
abline(lm(cereal$rating~cereal$fiber), col="red")

plot(cereal$sugars, cereal$rating,
 xlab="Sugar",
 ylab="Rating",
 main="Rating vs Sugar")
abline(lm(cereal$rating~cereal$sugars), col="red")

plot(cereal$protein, cereal$rating,
 xlab="Protein",
 ylab="Rating",
 main="Rating vs Protein")
abline(lm(cereal$rating~cereal$protein), col="red")

plot(cereal$potass, cereal$rating,
 xlab="Potassium",
 ylab="Rating",
 main="Rating vs Potassium")
abline(lm(cereal$rating~cereal$potass), col="red")


```


# What are the calories grouped by shelfs? What is the relation between the shelf display and nutritional information? Which self display(1, 2, or 3) have the highest/lowest ratings? 

```{r message = FALSE, warning = FALSE}
cereal %>% 
  ggplot(aes(calories, shelf, group = shelf, fill = shelf)) + 
  geom_violin()         
  
cereal %>% 
  ggplot(aes(sugars, shelf, group = shelf, fill = shelf)) + 
  geom_violin()    

cereal %>% 
  ggplot(aes(carbo, shelf, group = shelf, fill = shelf)) + 
  geom_violin()  
```


```{r message = FALSE, warning = FALSE}
treemap(cereal, index = c("rating", "name"), vSize = "rating", 
        fontsize.labels=c(8,12),               
        fontcolor.labels=c("Black","Navy blue"),    
        fontface.labels=c(8,9))


cereal %>% 
  ggplot(aes(x= rating, y = calories)) +
  geom_col(color = "blue") +
  facet_wrap(~ shelf)
cereal %>% 
  ggplot(aes(x= rating, y = sugars)) +
  geom_col(color = "blue") +
  facet_wrap(~ shelf)


```